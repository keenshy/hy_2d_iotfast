# 云平台

## 阿里云iot in


        阿里云iot in节点用于将采集到的数据上传阿里云平台。

### 一、节点介绍
#### 节点外观
![1596251446637-a2b72002-b2fa-4167-aa27-2bfd3d345457.png](./img/Duo1aJ6Bxq5Xi6JP/1596251446637-a2b72002-b2fa-4167-aa27-2bfd3d345457-932672.png)

#### 节点属性
+ **产品Key** | 字符串 输入ProductKey标识
+ **设备名称** | 字符串 输入DeviceName标识
+ **设备密钥** | 字符串 输入DeviceSecret标识
+ **地域** | 字符串 cn-shanghai

### 二、示例
        示例中包含个别配置字段无法保存，请自行根据现实情况配置。示例中教程可以通过拷贝示例代码实现快速复用，在新建的流程中点击界面右侧 **菜单栏-导入-剪贴板** ，在文本框中粘贴下面代码后点击确定，即可快速复用。

#### 数据上传
        用阿里云iot in节点对采集数据进行上传。

        连接示意图如下，将温湿度数据上传到阿里云。

![1596251446683-bb2ffba8-d798-44b3-988a-30fe499c4324.png](./img/Duo1aJ6Bxq5Xi6JP/1596251446683-bb2ffba8-d798-44b3-988a-30fe499c4324-906504.png)

        我们打开阿里云平台，创建完产品和设备后会有三个唯一标识，如下图。

![1596251446669-ef9b2504-9071-43a1-a450-2899cc11a6f5.png](./img/Duo1aJ6Bxq5Xi6JP/1596251446669-ef9b2504-9071-43a1-a450-2899cc11a6f5-451749.png)

        回到海创微联，打开阿里云iot in，输入三个唯一标识，点击部署，如下图。

![1596251446757-81320c1f-3cb3-476d-92c3-1ba619cd242d.png](./img/Duo1aJ6Bxq5Xi6JP/1596251446757-81320c1f-3cb3-476d-92c3-1ba619cd242d-945481.png)

        然后我们就能在阿里云平台的运行状态中看到上传的数据了。

![1596251446743-351bbb8f-0192-4225-8e38-a36f6d320d67.png](./img/Duo1aJ6Bxq5Xi6JP/1596251446743-351bbb8f-0192-4225-8e38-a36f6d320d67-064766.png)

示例代码：

```plain
[{"id":"eb26b167.e06e9","type":"inject","z":"1d40d649.042bfa","name":"","topic":"","payload":"","payloadType":"date","repeat":"30","crontab":"","once":false,"onceDelay":0.1,"x":155,"y":340,"wires":[["d57d8456.733d78"]]},{"id":"d57d8456.733d78","type":"iot-modbus","z":"1d40d649.042bfa","name":"温湿度","server":"66cafcba.d9e4e4","fc":"HoldingRegister","columns":[{"Key":"CurrentTemperature","Label":"温度","UnitId":"1","Address":"0","Quantity":"1","ValueType":"Int16BE","Arithmetic":"%s/100"},{"Key":"CurrentHumidity","Label":"湿度","UnitId":"1","Address":"1","Quantity":"1","ValueType":"Int16BE","Arithmetic":"%s/100"}],"x":275,"y":340,"wires":[["f1435f78.ea5fa"]]},{"id":"3b3e8d28.6da492","type":"debug","z":"1d40d649.042bfa","name":"温湿度","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":515,"y":340,"wires":[]},{"id":"f1435f78.ea5fa","type":"aliyun-iot","z":"1d40d649.042bfa","productKey":"","deviceName":"","deviceSecret":"","regionId":"","x":395,"y":340,"wires":[["3b3e8d28.6da492"]]},{"id":"66cafcba.d9e4e4","type":"iot-modbus-client","z":"","name":"","clienttype":"Modbus-TCP","host":"192.168.7.143","post":"4196","tcptype":"Telnet","serialport":"COM1","serialtype":"RTU-Buffered","baudrate":"9600","databits":"8","stopbits":"1","parity":"None","unitid":"1","timeout":"2000","sleep":"200","showActivity":false}]
```

---

## 阿里云iot out


阿里云iot out节点用于将返回阿里云平台采集的数据。

### 节点介绍
#### 节点外观
![1596251446663-36967cf7-9c6f-4619-bf0c-08cf92c63620.png](./img/Duo1aJ6Bxq5Xi6JP/1596251446663-36967cf7-9c6f-4619-bf0c-08cf92c63620-387726.png)

#### 节点属性
+ **产品Key** | 字符串 输入ProductKey标识
+ **设备名称** | 字符串 输入DeviceName标识
+ **设备密钥** | 字符串 输入DeviceSecret标识
+ **地域** | 字符串 cn-shanghai

---

## 华为云iot in


节点用于将设备采集到的数据上传至华为云平台。

### 一、节点介绍


#### 节点外观


![1613696111507-b421ed87-0c77-49d2-96e0-d679422a4392.png](./img/Duo1aJ6Bxq5Xi6JP/1613696111507-b421ed87-0c77-49d2-96e0-d679422a4392-579837.png)



#### 节点属性


+ **名称** | 字符串 输入控件名称
+ **设备配置** | 输入设备名称、设备唯一ID标识、设备密匙以及接入平台的域名与端口号
+ **模式** | 选择数据传输模式
+ **qos** | （服务质量）用于为不同的流量提供不同的优先级，以控制延迟和抖动，并降低丢包率。当网络过载或拥塞时，QoS可以确保关键业务流量的正常传输
+ **服务ID** | 设备服务ID，需要在产品创建成功后进行模型定义，增加数据采集类型属性。



### 二、示例


     示例中包含个别配置字段无法保存，请自行根据现实情况配置。示例中教程可以通过拷贝示例代码实现快速复用，在新建的流程中点击界面右侧 **菜单栏-导入-剪贴板** ，在文本框中粘贴下面代码后点击确定，即可快速复用。



#### 数据上传


     用华为云iot input节点对采集数据进行上传。



     连接示意图如下，将灯光采集数据上传到华为云平台。



![1613696111521-d1592fc7-d7c1-4651-94a7-fb513f28ca2b.png](./img/Duo1aJ6Bxq5Xi6JP/1613696111521-d1592fc7-d7c1-4651-94a7-fb513f28ca2b-199289.png)



平台创建产品：

![1613696111522-16d03257-9507-4a16-8ab2-440d3c83e05b.png](./img/Duo1aJ6Bxq5Xi6JP/1613696111522-16d03257-9507-4a16-8ab2-440d3c83e05b-109106.png)



创建成功后提示创建产品成功，接下来便是定义设备模型以及添加和调试设备。



![1613696111529-341d9c60-57cc-4c27-8ea8-25c38baa3d8f.png](./img/Duo1aJ6Bxq5Xi6JP/1613696111529-341d9c60-57cc-4c27-8ea8-25c38baa3d8f-610038.png)



定义模型，创建服务ID，添加设备属性：



![1613696111532-d86504e8-d494-46b4-969d-c4349015822a.png](./img/Duo1aJ6Bxq5Xi6JP/1613696111532-d86504e8-d494-46b4-969d-c4349015822a-172732.png)



属性添加



![1613696111543-c49899af-4c6b-4901-860a-48c6c8511c6f.png](./img/Duo1aJ6Bxq5Xi6JP/1613696111543-c49899af-4c6b-4901-860a-48c6c8511c6f-000646.png)



添加属性完成



![1613696111543-39e10093-3883-4647-865d-f0cdfe0997ae.png](./img/Duo1aJ6Bxq5Xi6JP/1613696111543-39e10093-3883-4647-865d-f0cdfe0997ae-513949.png)



添加设备



![1613696111552-f484db09-c441-4d11-a58f-1d2d6903a117.png](./img/Duo1aJ6Bxq5Xi6JP/1613696111552-f484db09-c441-4d11-a58f-1d2d6903a117-052855.png)



添加设备成功后提示创建设备成功



![1613696111584-191c9403-358d-4a4b-8f15-89b65ed056fb.png](./img/Duo1aJ6Bxq5Xi6JP/1613696111584-191c9403-358d-4a4b-8f15-89b65ed056fb-371452.png)



得到设备ID以及密匙,该设备ID以及密匙将用于部署配置边缘网关采集控制系统中的华为云控件



![1613696111571-be5f8f88-fb7a-4e94-8168-5d37fc4b74cc.png](./img/Duo1aJ6Bxq5Xi6JP/1613696111571-be5f8f88-fb7a-4e94-8168-5d37fc4b74cc-947704.png)



配置域名和端口



![1613696111571-14ec8369-153e-4a2e-a64f-337fa00e2955.png](./img/Duo1aJ6Bxq5Xi6JP/1613696111571-14ec8369-153e-4a2e-a64f-337fa00e2955-534609.png)



填入前面设置的服务ID



![1613696111572-6fa28099-8e36-4514-9b75-b7d74b618292.png](./img/Duo1aJ6Bxq5Xi6JP/1613696111572-6fa28099-8e36-4514-9b75-b7d74b618292-929141.png)



配置完成后采集控制系统点击部署



![1613696111575-1e3413ed-5fc5-4a9e-b870-4db9040a0424.png](./img/Duo1aJ6Bxq5Xi6JP/1613696111575-1e3413ed-5fc5-4a9e-b870-4db9040a0424-853300.png)



即可看到设备在线



![1613696111570-a3f67821-13e2-4dea-8f75-369878cc08f5.png](./img/Duo1aJ6Bxq5Xi6JP/1613696111570-a3f67821-13e2-4dea-8f75-369878cc08f5-498244.png)



配置输出function函数，通过定时器触发使之输出灯的属性值



![1613696111566-814c0845-412e-40ee-8e3c-5f8375649446.png](./img/Duo1aJ6Bxq5Xi6JP/1613696111566-814c0845-412e-40ee-8e3c-5f8375649446-586209.png)



点击定时器触发，然后我们就能在阿里云平台的运行状态中看到上传的数据了。



![1613696111572-5b3c8e5a-9861-4656-a887-b3ff90d80bf9.png](./img/Duo1aJ6Bxq5Xi6JP/1613696111572-5b3c8e5a-9861-4656-a887-b3ff90d80bf9-656949.png)



示例代码：



[{"id":"6053634d.a4ff4c","type":"huawei-iot-out","z":"5ff8e90b.6a06a8","name":"实验室灯组","qos":"0","mode":"report","services":"led1","broker":"c958c532.0b6938","x":755,"y":260,"wires":[]},{"id":"c958c532.0b6938","type":"huawei-iot-broker","z":"","name":"实验室灯组1","broker":"a1601518d3.iot-mqtts.cn-north-4.myhuaweicloud.com","port":"1883"}]

## **华为云iot out**
****

华为云iot out节点用于将返回华为云平台采集的数据。



#### 节点外观


![1613697256495-5348959f-f6ce-4adb-a886-4d6c80cbb3c8.png](./img/Duo1aJ6Bxq5Xi6JP/1613697256495-5348959f-f6ce-4adb-a886-4d6c80cbb3c8-882232.png)



#### 节点属性


+ **名称** | 字符串 输入控件名称
+ **设备配置** | 输入设备名称、设备唯一ID标识、设备密匙以及接入平台的域名与端口号
+ **模式** | 选择数据传输模式
+ **qos** | （服务质量）用于为不同的流量提供不同的优先级，以控制延迟和抖动，并降低丢包率。当网络过载或拥塞时，QoS可以确保关键业务流量的正常传输
+ **服务ID** | 设备服务ID，需要在产品创建成功后进行模型定义，增加数据采集类型属性。



> 更新: 2024-03-21 14:18:43  
> 原文: <https://www.yuque.com/iot-fast/ckyq/ece60s>