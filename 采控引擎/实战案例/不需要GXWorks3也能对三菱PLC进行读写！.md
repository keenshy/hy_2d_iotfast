# 不需要GX Works3也能对三菱PLC进行读写！

如何不通过三菱的编程软件**GX Works3**，也能对三菱PLC的点位进行读写？使用**IoT-Fast**<font style="color:rgb(44, 62, 80);">，超低代码就能实现</font>，**IoT-Fast**<font style="color:rgb(44, 62, 80);">是一款</font>集合了数据采集、上报云端、图形组态为一体的软件

文章以三菱PLC-FX5U为例，包括梯形图，采集，上云，组态，共分为五个部分：

+ **GX Works3**的使用

> 简单介绍编程软件GX Works3的使用，并编写梯形图。
>

+ **IoT-Fast-**采集控制系统

> 对底层设备进行数据读取、写入的配置界面，还可以进行数据处理。
>

+ **IoT-Fast**-云平台

> 将采集控制系统收集的数据进行分类展示、告警阈值设置、历史数据查询等功能。
>

+ **IoT-Fast**-云组态

> 进行2D组态，组态元素绑定云平台上展示的数据，来进行动作的执行或是数据展示。
>

+ **IoT-Fast**-微信小程序/App

> 通过微信小程序或者手机app进行远程数据的查看，以及动作的执行。
>

### 一、**GX Works3**的使用
打开三菱编程软件**GX Works3**。

![20220420165641.png](./img/t5yOQA5cQYNStsld/1651886261067-463e2f7b-d50a-43c6-9638-5c5f37fb9383-733749.png)

打开GX Works3，新建工程，选择型号FX5U。

![20220421083509.png](./img/t5yOQA5cQYNStsld/1651886261027-d8d2687e-365b-452c-a0e8-fa87f96f1f64-640803.png)

创建成功进入主界面。

![20220506095126.png](./img/t5yOQA5cQYNStsld/1651886261085-998d222f-11ae-4855-bb86-eaa1be05c408-463655.png)

编写梯形图，**梯形图**如下，M0、M1、M2、M3分别控制4个输出Y0、Y1、Y2、Y3。

![20220506100030.png](./img/t5yOQA5cQYNStsld/1651886261030-0178d2ba-e6c6-4866-b1b2-f254bebcbcf0-506284.png)

完成后点击上方的**在线**-**写入可编程控制器**，将程序写入PLC。

![20220506100259.png](./img/t5yOQA5cQYNStsld/1651886261187-56ee9714-8008-45d2-87ad-c20fa288dd26-289432.png)

点击开始监视，选择监视读取，也可以在监看中添加需要监看的点位。

![20220506101736.png](./img/t5yOQA5cQYNStsld/1651886261196-2910e87e-7877-47d0-bb27-417e9b578a7b-829376.png)

然后我们用**<font style="color:rgb(44, 62, 80);">IoT-Fast</font>**对点位进行读写。

### 二、<font style="color:rgb(44, 62, 80);">IoT-Fast</font>-采集控制系统
打开<font style="color:rgb(44, 62, 80);">IoT-Fast</font>的**采集控制**系统，选择左边的节点，按住鼠标左键拖入到中间的配置栏。

![20220506102101.png](./img/t5yOQA5cQYNStsld/1651886261047-8fe5135c-62a1-4f2f-85b2-e4d07162db63-523748.png)

我们从左侧的采集引擎拉出**MC**采集控件（三菱通讯协议）。

![20220506102607.png](./img/t5yOQA5cQYNStsld/1651886261030-77cd0835-31d9-4db3-9dfb-636149e2b1ac-279302.png)

双击控件进入配置界面，配置采集的点位，点位的**标识符**用于和云平台进行关联对应；**功能名称**是备注的作用，方便自己理解该点位的含义，可不填；**内存域**就是PLC中的M、D、X、Y等等；**地址**则是该内存域下的地址，具体配置如下。

![20220506103234.png](./img/t5yOQA5cQYNStsld/1651886261192-5b0d5425-4c8e-44d7-a07f-fd32bc228ce2-076799.png)

点击配置界面上面的小铅笔进入通讯配置界面，填写三菱PLC的ip端口等。

![20220506103354.png](./img/t5yOQA5cQYNStsld/1651886261096-809b1a16-aea1-4a59-b27d-d04ff24ecf70-888073.png)

PLC的IP和通讯模式在左侧的**参数**-**FX5UCPU**-**模块参数**-**以太网端口**中查看。

![20220506104205.png](./img/t5yOQA5cQYNStsld/1651886261319-f850b439-3c7c-4e16-aa39-c48455474c91-254045.png)

端口需要点击**对象设备连接配置设置**，点击**详细设置**查看，如果之前没有配置则需要从右侧拉出连接端口，配置一个端口，这里我配置了两个，一个9600一个9601，配置后记得保存下载到PLC中。

![20220506103937.png](./img/t5yOQA5cQYNStsld/1651886261119-2e02b7eb-01de-490e-a632-c04359d1033e-172788.png)

接着从控制引擎中拉出**MC**控制控件，同样对控制点位进行配置。

![20220506104308.png](./img/t5yOQA5cQYNStsld/1651886261080-4a85b106-a2e5-4365-8da1-3623a913808e-147926.png)

![20220506104446.png](./img/t5yOQA5cQYNStsld/1651886261117-560b6288-a415-4e51-8afb-9547cfc58564-682647.png)

在共通控件中拉出**定时器**和**调试**控件。

![20220413140700.png](./img/t5yOQA5cQYNStsld/1650779619519-0d037a9a-5579-4c87-be38-a5e35d8e290b-199184.png)

在两个控件中用线两接起来，数据是从左往右流的。触发定时器时，顺着连接线对PLC进行一次采集，采集后返回的结果再顺着连接线到右边的调试控件，调试控件则会将结果显示在最右边的调试窗口。  
![20220506104532.png](./img/t5yOQA5cQYNStsld/1651886261112-63744b02-c332-4802-b10f-2ca073dd7695-067801.png)

完成后点击右上角的**部署**按钮。

![20220413140830.png](./img/t5yOQA5cQYNStsld/1650779619483-456bd948-a1a9-4b57-8552-131ce931cc72-131469.png)

部署完成后通讯控件会显示**连接成功**，点击定时器前面的按钮，在右边的调试窗口中能看到采集的点位数据。

![20220506104620.png](./img/t5yOQA5cQYNStsld/1651886261157-b850f9be-66af-48d3-a441-25191c5cc5d1-632955.png)

然后我们先去云平台创建一下产品和设备，再回过头来做数据处理。

### 三、<font style="color:rgb(44, 62, 80);">IoT-Fast</font>-云平台
点击云平台按钮进入**云平台**首页。

![1699001039979-889361f0-2fc9-45a1-a77c-a1a7aea0b495.png](./img/t5yOQA5cQYNStsld/1699001039979-889361f0-2fc9-45a1-a77c-a1a7aea0b495-014893.png)

点击左侧**产品中心**-**产品开发**，新增一个产品，类别选择**自定义品类**。

![20220506110945.png](./img/t5yOQA5cQYNStsld/1651886261136-94dd08c4-998e-430e-a4da-dae0c28db335-366546.png)

查看创建好的产品，在**功能定义**-**自定义参数**中新增采集控制的数据点，我们将M点对应成开关，Y点对应灯。

![20220506113702.png](./img/t5yOQA5cQYNStsld/1651886261160-259744df-01cb-4a71-9550-803faf96222e-161570.png)

配置如下，注意**标识符**要和采集控制系统中的**标识符**一致。

![20220506113511.png](./img/t5yOQA5cQYNStsld/1651886261063-4a826bc2-6d4d-496c-b20c-2119fcb4ac5a-359412.png)

![20220506111252.png](./img/t5yOQA5cQYNStsld/1651886261036-5b763939-ee61-403a-a14d-e31b6213d099-779027.png)

在**功能定义**-**分组**中创建上报和下发分组。

![20220506111746.png](./img/t5yOQA5cQYNStsld/1651886261088-71fef4f7-5f4e-4e66-bca6-b95720f9de12-586793.png)

创建一个上报分组，类型选择上报，将左边的点位全选，点击右箭头，加入到当前分组中。

![20220506113757.png](./img/t5yOQA5cQYNStsld/1651886261076-1af1fa4f-f4c5-4696-aaa5-9b94a39ff4f0-572082.png)

创建一个下发分组，类型选择下发，一样将左边的点位加入到当前分组中。

![20220506113839.png](./img/t5yOQA5cQYNStsld/1651886261077-4e6b6076-1312-46ee-8017-983fbc9bff11-079035.png)

接着点击**产品中心**-**设备管理**，在该产品下增加一个设备。

![20220506111849.png](./img/t5yOQA5cQYNStsld/1651886261145-c5326731-57c8-4542-99de-49fd5f62857f-354602.png)

查看设备的**运行状态**，就能看到刚刚定义的点位已经创建出来了，后续采集控制系统上报的数据就会在这边展示。

![20220506114027.png](./img/t5yOQA5cQYNStsld/1651886261135-87c9b1b1-a580-4250-a47a-5ac0608eac10-383647.png)

回到采集控制系统，从左侧云平台中拉出**iotfast云上行**和**iotfast云下行**控件。上行用于将采集的数据上报，下发用于云端下发控制指令。

![1699001095555-7fcb84e0-700d-4ba5-9a76-60a4c6874e08.png](./img/t5yOQA5cQYNStsld/1699001095555-7fcb84e0-700d-4ba5-9a76-60a4c6874e08-868355.png)

双击控件就可以选择刚刚在云平台创建的产品、设备和分组了。

![20220506112412.png](./img/t5yOQA5cQYNStsld/1651886261111-1219ebe3-bc46-4683-a0f2-fe9424840ff8-604625.png)

在**微联云下行**后面接一个**调试**控件，方便排查问题，然后点击部署，完成后显示连接成功，点击定时器，调试窗口显示操作成功。

![20220506112450.png](./img/t5yOQA5cQYNStsld/1651886261147-60f6ea65-4325-4179-9ea3-7b7911fd1273-093307.png)

回到云平台，查看设备的**运行状态**，可以看到数据已经显示出来了。

![20220506113925.png](./img/t5yOQA5cQYNStsld/1651886261161-44d8e194-3d7b-46df-974f-5d5e790f9eac-380461.png)

查看设备的**设备调试**，模拟一个下发控制，开关选择开，点击发送。

![20220506114334.png](./img/t5yOQA5cQYNStsld/1651886261148-bd9e0b75-581f-4302-a640-30c0ae935baf-332751.png)

回到采集控制系统，可以看到从云平台下发出来的报文格式。

![20220506114404.png](./img/t5yOQA5cQYNStsld/1651886261240-fd3ad141-a4c9-4531-a1e0-45490570dc88-450666.png)

我们对下发的格式做一下处理，从左侧拉出一个**F(X)** 控件，接在**微联云下行**和**S7**控制控件中间，双击写一些简单的代码，将msg.payload.data.params下的值提取到msg.payload下。

![20220506144327.png](./img/t5yOQA5cQYNStsld/1651886261192-6a11763f-9154-4fcd-86ea-651f8cdc48ae-190486.png)

双击**定时器**设置周期性触发，周期1s，点击部署，采集控制系统就全部配置完成了。

![20220506115913.png](./img/t5yOQA5cQYNStsld/1651886261142-04257d0f-8e98-4b5e-8f0d-5e7969fcc39e-052603.png)

回到设备的**设备调试**，对M0和M2写入true。

![20220506134006.png](./img/t5yOQA5cQYNStsld/1651886261114-d2d50736-855b-4c76-aff9-b35dedd326e6-408414.png)

查看设备的**运行状态**，可以看到M0和M2对应的开关和灯都是开的。

![20220506135010.png](./img/t5yOQA5cQYNStsld/1651886261174-255ffe7d-51ee-43b2-8b11-2085f74a6935-929032.png)

回到**GX Works3**，可以看到写入成功

![20220506135051.png](./img/t5yOQA5cQYNStsld/1651886261199-c052ad8c-e292-41aa-a717-3f1849608c46-127064.png)

接着在云组态中进行组态，绑定云平台的数据。

### 四、<font style="color:rgb(44, 62, 80);">IoT-Fast</font>-云组态
点击云组态按钮进入**云组态**首页。

![20220506135213.png](./img/t5yOQA5cQYNStsld/1651886261122-d54faf15-cc86-423c-8c16-32c4bf2c2aa5-475467.png)

先新建一个项目，填写项目名称，保存，进入项目。

![20220425141729.png](./img/t5yOQA5cQYNStsld/1651736759386-c16fcc0f-923f-4c75-a74b-4f1d3102cd28-653349.png)

点击**应用**-**我的应用**，点击图示位置新增一张图纸，来构建组态。

![20220506135444.png](./img/t5yOQA5cQYNStsld/1651886261196-4cf83ff8-72bd-4680-8441-17f80bd50eb5-089552.png)

填写图纸名称后就可以开始画组态图了。

![20220425141943.png](./img/t5yOQA5cQYNStsld/1651736759420-5e44d71e-d004-4d05-ad7c-b1c3697d311e-742755.png)

可以在左侧项目树中选择**图标**使用现成的组件，也可以在**设计**中设计自己需要的组件。

![20220506135641.png](./img/t5yOQA5cQYNStsld/1651886261268-4fe8f7ea-6613-48da-8721-3561b442c818-045232.png)

点击图纸空白处，在右侧修改图纸大小和背景颜色。

![20220506135836.png](./img/t5yOQA5cQYNStsld/1651886261332-a558721a-1f0e-447c-9c8b-1998a4646bf5-763867.png)

从图标中拷贝一个指示灯，粘贴到设计中微调成需要的组件。

![20220425142128.png](./img/t5yOQA5cQYNStsld/1651736759414-d9aa1cf3-e951-401c-aed1-1a1ef96a95af-537228.png)

点击设计，创建一个新的文件夹，然后粘贴指示灯，双击进行调整，调整完成后保存。

![20220506140042.png](./img/t5yOQA5cQYNStsld/1651886261210-26e3a592-4d25-4358-905b-f01efe056960-314623.png)

我们拉出刚刚设计的指示灯4个，然后为它们命名，全选，点击上方的分布和对齐调整位置。

![20220506140725.png](./img/t5yOQA5cQYNStsld/1651886261243-03e6aba5-27aa-44cc-adec-4e2f17db0095-242712.png)

接着从图标中拉出4个开关组件，命名调整位置。

![20220506141628.png](./img/t5yOQA5cQYNStsld/1651886261249-6b9ea6c2-8b4c-4e2c-8eb2-cf7316ce1939-887787.png)

下面一步要将组件绑定上数据，选中一个灯，点击箭头处的图标绑定数据。

![20220506142352.png](./img/t5yOQA5cQYNStsld/1651886261226-c6586846-7059-4e8e-9b8e-e1d31707ac2d-936460.png)

**选择数据源**-设备，**来源**-我的，**产品**-云平台创建的产品，**设备**-云平台创建的设备，**属性**-选择灯0，点击确定。剩下的灯和开关同理，依次进行绑定。

![20220506142007.png](./img/t5yOQA5cQYNStsld/1651886261218-b30aa397-1f6d-4fff-bb9f-ac6decc09302-722046.png)

绑定完成后对于有控制的开关需要进行一下交互设置，选中开关，点击右上角的**交互**，双击**鼠标单击时**。

![20220506152600.png](./img/t5yOQA5cQYNStsld/1651886261222-04ea9572-8296-415c-9cf4-1535785bf19d-238647.png)

对这个控制进行命名，然后点击添加条件。

![20220506152647.png](./img/t5yOQA5cQYNStsld/1651886261256-ea9d93b0-c820-4393-8981-c3a5946cf18b-478358.png)

设置条件，当开关这个组件的值为false时触发。

![20220506174007.png](./img/t5yOQA5cQYNStsld/1651886261211-9da7ee30-bfab-4888-9456-85d4ac3a7dd2-572667.png)

点击左边的**数据反馈**设置交互动作，动作为：对开关写true，最后保存。

![20220506174050.png](./img/t5yOQA5cQYNStsld/1651886261206-14902539-5879-4b62-b5e2-2a82866c7fed-680628.png)

这条交互的含义是：当开关当前的值为false时，单击开关，开关会触发动作，给云端发送开关为true的指令。同样，设置一条对立的交互，开关为true时，单击开关触发false。

![20220506174232.png](./img/t5yOQA5cQYNStsld/1651886261204-47bb2046-7ad2-4d9d-bf21-73d57dfacc82-015528.png)

全部的开关都配置完成后点击**保存**，然后点击右上角的**预览**。

![20220418150540.png](./img/t5yOQA5cQYNStsld/1650779619647-033423b4-1f29-465a-ab41-bbd9d0062ff1-471533.png)

![20220506150706.png](./img/t5yOQA5cQYNStsld/1651886261177-5e855cad-c4b0-42a1-b478-4afcad4373d7-378859.png)

点击开关，对应的灯会亮会启动。

![20220507085633.png](./img/t5yOQA5cQYNStsld/1651886261212-8e25e79b-fbf1-4be8-a281-a03cb812d7cf-280653.png)

![20220507085542.png](./img/t5yOQA5cQYNStsld/1651886261224-a0519a7b-584b-4025-bac2-b8d1a6a62b79-442637.png)

### 五、<font style="color:rgb(44, 62, 80);">IoT-Fast</font>-微信小程序/APP
软件上的数据支持在**微信小程序**或者**APP**上查看，小程序和APP的二维码在**云平台**首页的右侧，目前只支持安卓APP，ios的用户可以直接用微信小程序查看。

![1699001271701-bf98ba19-6a1f-429b-a6e2-c107243c42e6.png](./img/t5yOQA5cQYNStsld/1699001271701-bf98ba19-6a1f-429b-a6e2-c107243c42e6-474900.png)

扫码进入<font style="color:rgb(44, 62, 80);">IoT-Fast</font>小程序，输入PC端注册的账号密码。

![1654594313521-cf5abdf3-a8fd-46db-9f66-64ee1f5f31f6.png](./img/t5yOQA5cQYNStsld/1654594313521-cf5abdf3-a8fd-46db-9f66-64ee1f5f31f6-542533.png)

进入首页，可以看到产品和设备数量，点击**设备**查看该账号下的所有设备。

![1654594347250-dd0980ad-bd80-4516-b8ec-1220e30752d3.png](./img/t5yOQA5cQYNStsld/1654594347250-dd0980ad-bd80-4516-b8ec-1220e30752d3-166423.png)

选择在线设备，点击查看可以看到设备的详细信息。

![1654596171230-ba3bd773-b83a-4546-b24e-a746c5fe32f1.png](./img/t5yOQA5cQYNStsld/1654596171230-ba3bd773-b83a-4546-b24e-a746c5fe32f1-642403.png)

![1654596186279-0330f95a-33b4-45fb-b812-81143194d3d0.png](./img/t5yOQA5cQYNStsld/1654596186279-0330f95a-33b4-45fb-b812-81143194d3d0-741051.png)

点击**运行状态**右侧的箭头可以查看设备的实时数据。

![1654596200627-d4ad4bf1-d527-4f13-ad6b-331ba06f8931.png](./img/t5yOQA5cQYNStsld/1654596200627-d4ad4bf1-d527-4f13-ad6b-331ba06f8931-270180.png)

点击**设备控制**右侧的箭头则是可以对设备进行指令下发。

![1654596211340-901c24ae-fd0b-4dfc-941d-0f33fd41344a.png](./img/t5yOQA5cQYNStsld/1654596211340-901c24ae-fd0b-4dfc-941d-0f33fd41344a-095247.png)

回到首页，点击**组态**查看该账号下的所有组态，选择三菱FX5U点控，点击查看。

![1654596239954-3996a43e-b4b0-4784-a543-69be12b75de9.png](./img/t5yOQA5cQYNStsld/1654596239954-3996a43e-b4b0-4784-a543-69be12b75de9-881260.png)

和PC端一样，点击按钮就可以对组态进行控制。

![1654596228539-04049593-1747-41c4-8df3-546225ea6c52.png](./img/t5yOQA5cQYNStsld/1654596228539-04049593-1747-41c4-8df3-546225ea6c52-121373.png)



> 更新: 2024-03-21 14:18:56  
> 原文: <https://www.yuque.com/iot-fast/ckyq/qzgic6>